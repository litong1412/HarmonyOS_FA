# hms-js-base

# Contents

1. Introduction
2. Installation Guide
3. Function Definitions & Sample
4. Licencing & Terms

## 1. Introduction

The SDK provides the ability to use HMS Core with JavaScript under multiple platforms (RN, OHOS, QuickApp, Cordova).


## 2. Installation Guide

- Go to your project
```bash
cd example/
```
- Install
```bash
npm i @hmscore/hms-js-base 
```
  
```text
project-name
    |_ node_modules
        |_ ...
        |_  @hmscore/hms-js-base
        |_ ...
```

- import hms-js-base package to your application
```JavaScript
import { hmsjsb, hmsbase } from '@hmscore/hms-js-base'
```

## 3. Function Definitions & Sample

* Function Definitions
    - [hmsjsb](#hmsjsb)
        - [hmsjsb.invoke({apiName, args, success, fail, complete})](#hmsjsbinvokeapiname-args-success-fail-complete)
        - [hmsjsb.on(eventName, callback, eventCallbackMap)](#hmsjsboneventname-callback-eventcallbackmap)
        - [hmsjsb.off(eventName, offKey, eventCallbackMap)](#hmsjsboffeventname-offkey-eventcallbackmap)
        - [hmsjsb.init(params)](#hmsjsbinitparams)
        - [hmsjsb.destroy()](#hmsjsbdestroy)
* Sample
    * [OHOS example](#OHOSexample)


 <a name="hmsjsb.invoke"></a>

### hmsjsb.invoke({apiName, args, success, fail, complete})
Call the HMS Core method. 

**The returns of callback & promise are supported. When the paramters contain success/fail/complete, it will return from callbacks, otherwise it will return a promise.**

| Parameters | Type | Required |Description |
| --- | --- | --- | --- |
| apiName | <code>string</code> | yes | JAVA API name |
| args | <code>Object</code> | no | params |
| success | [<code>successCallback</code>](#successCallback) | no |success callback |
| fail | [<code>failCallback</code>](#failCallback) | no |fail callback |
| complete | [<code>completeCallback</code>](#completeCallback) | no |complete callback |

### return value： [<code>result</code>](#callbackResult)  


### example

```javascript
// callback
hmsjsb.invoke({
  apiName: 'update.availability',
  args: {
    min_api_level: 2,
  },
  success: (result) => {
    console.info(JSON.stringify(result));
  },
  fail: (error) => {
    console.info(JSON.stringify(error));
  }
});

// promise 
hmsjsb.invoke({
  apiName: 'update.availability',
  args: {
    min_api_level: 2,
  }
}).then(res => console.info(JSON.stringify(res)))
.catch(err => console.info(JSON.stringify(err)));
```

<a name="hmsjsb.on"></a>

### hmsjsb.on(eventName, callback, eventCallbackMap)
listen for HMS Core events. After the interface is called, the listener will start automatically. You can use hmsjsb.off to stop listening.
  
| Parameters | Type | Required |Description |
| --- | --- | --- | --- |
| eventName | <code>string</code> | yes |event name |
| callback | <code>function</code> | yes |event callback |
| eventCallbackMap | <code>Object</code> | no |event callback map, only used in OHOS, other platforms can ignore it  |

### return value： [<code>result</code>](#callbackResult) 

<a name="hmsjsb.off"></a>

### hmsjsb.off(eventName, offKey, eventCallbackMap)
Stop listening for HMS Core events, call it when the page is destroyed. 

| Parameters | Type | Required |Description |
| --- | --- | --- |--- |
| eventName | <code>string</code> | yes| event name |
| offKey | <code>\*</code> | yes | type is function or string, Event callback or hmsjsb.on result |
| eventCallbackMap | <code>Object</code> | no | event callback map,only used in OHOS, other platforms can ignore it  |

### return value ：[<code>result</code>](#callbackResult)

<a name="hmsjsb.init"></a>

### hmsjsb.init(params)
Before calling the hmsjsb methods,call the method to initialize

**Note: Currently only the `React Native` and `OHOS` platforms need to call this method, other platforms can ignore it.**
  

| Parameters | Type | Required |Description |
| --- | --- | --- |--- |
| params | <code>Object</code> | no | RN and OHOS are must input, RN example:{ NativeModules, DeviceEventEmitter }, OHOS example:{}|

### return value： [<code>result</code>](#callbackResult)

<a name="hmsjsb.destroy"></a>

### hmsjsb.destroy()
Before the page is destroyed, call the method to destroy.

**Note: Currently only the `React Native` platform needs to call this method, other platforms can ignore it.**

### return value： [<code>result</code>](#callbackResult)

<a name="successCallback"></a>

## successCallback : <code>function</code>
success callback.

**Kind**: global typedef  

| Parameters | Type | Description |
| --- | --- | --- |
| result | [<code>object</code>](#callbackResult) | result |

<a name="failCallback"></a>

## failCallback : <code>function</code>
fail callback.

**Kind**: global typedef  

| Parameters | Type | Description |
| --- | --- | --- |
| result | [<code>object</code>](#callbackResult) | result |
<a name="completeCallback"></a>

## completeCallback : <code>function</code>
complete callback.

**Kind**: global typedef  

| Parameters | Type | Description|
| --- | --- | --- |
| result | [<code>object</code>](#callbackResult) | result |

<a name="callbackResult"></a>

## result : <code>object</code>
 the returned value of mothed or callback

**Kind**:  return value 

|Returns	|Type |Description| 
| --- | --- | --- |
| errCode | <code>number</code> | error code |
| errMsg | <code>string</code> | error message |
| data | <code>\*</code> | Type is function or string |
| extras | <code>object</code> | extras |

### OHOSexample

<a name="OHOSexample"></a>


  **Define the global variable eventCallbackMap in app.js, and then init hms-js-base at the onCreate method.**

```JavaScript
import { hmsjsb } from '@hmscore/hms-js-base'
//Define the global
hmsData: {
  eventCallbackMap: {},
}

//init
onCreate() {
  hmsjsb.init(this.hmsData.eventCallbackMap);
}
```
**Subscribe and unsubscribe events, need to match use.**

**Notes: When the event linstener is no longer needed or the page is destroyed, please stop listening**

```JavaScript
import router from '@system.router'
import { hmsjsb } from '@hmscore/hms-js-base'

export default {
  data: {
    title: "",
    eventCallbackId: ""
  },
  onInit() {
    //Subscribe
    this.eventCallbackId = hmsjsb.on("onBackground", (result) => {
      console.info("event callback result: " + JSON.stringify(result));
    }, this.$app.$def.hmsData.eventCallbackMap);
  },
  onDestroy() {
    //unsubscribe
    hmsjsb.off("onBackground", this.eventCallbackId,
      this.$app.$def.hmsData.eventCallbackMap);
  }
}
```

## 4. Licensing and Terms  
hms-js-base SDK uses the Apache 2.0 license.